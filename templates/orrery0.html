<html><head><base href="/">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive 3D Solar System Orrery with Apollo Asteroid Orbits</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    #info {
      position: absolute;
      top: 10px;
      width: 100%;
      text-align: center;
      color: white;
      font-family: Arial, sans-serif;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div id="info">Interactive 3D Solar System Orrery with Apollo Asteroid Orbits<br>Drag to rotate, scroll to zoom</div>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <script>
    let scene, camera, renderer, controls;
    let sun, mercury, venus, earth, mars;
    let orbitLines = [];

    const apolloData = [
      {spkid: 20001566, full_name: "1566 Icarus (1949 MA)", diameter: 1.0, e: 0.8270, a: 1.078, i: 22.80, om: 87.95, w: 31.43, ma: 160.86},
      {spkid: 20001620, full_name: "1620 Geographos (1951 RA)", diameter: 2.56, e: 0.3356, a: 1.246, i: 13.34, om: 337.15, w: 277.01, ma: 289.36},
      {spkid: 20001685, full_name: "1685 Toro (1948 OA)", diameter: 3.4, e: 0.4361, a: 1.368, i: 9.38, om: 274.21, w: 127.27, ma: 196.26},
      {spkid: 20001862, full_name: "1862 Apollo (1932 HA)", diameter: 1.5, e: 0.5599, a: 1.471, i: 6.35, om: 35.56, w: 286.03, ma: 252.87},
      {spkid: 20001863, full_name: "1863 Antinous (1948 EA)", diameter: 2.1, e: 0.6063, a: 2.261, i: 18.35, om: 346.00, w: 268.57, ma: 173.83},
      {spkid: 20001864, full_name: "1864 Daedalus (1971 FA)", diameter: 3.7, e: 0.6143, a: 1.461, i: 22.21, om: 6.61, w: 325.66, ma: 34.28},
      {spkid: 20001865, full_name: "1865 Cerberus (1971 UA)", diameter: 1.2, e: 0.4668, a: 1.08, i: 16.10, om: 212.89, w: 325.29, ma: 328.39},
      {spkid: 20001866, full_name: "1866 Sisyphus (1972 XA)", diameter: 8.48, e: 0.5380, a: 1.894, i: 41.21, om: 63.45, w: 293.12, ma: 349.34},
      {spkid: 20001981, full_name: "1981 Midas (1973 EA)", diameter: 3.4, e: 0.6505, a: 1.776, i: 39.82, om: 356.80, w: 267.84, ma: 258.81}
    ];

    const planetColors = {
      mercury: 0xFF00FF, // magenta
      venus: 0xFFFF00,   // yellow
      earth: 0x00FFFF,   // cyan
      mars: 0xFF0000     // red
    };

    function init() {
      scene = new THREE.Scene();
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.z = 50;
      camera.position.y = 30;

      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      controls.screenSpacePanning = false;
      controls.minDistance = 10;
      controls.maxDistance = 100;
      controls.maxPolarAngle = Math.PI / 2;

      const ambientLight = new THREE.AmbientLight(0x404040);
      scene.add(ambientLight);

      const pointLight = new THREE.PointLight(0xffffff, 2, 100);
      scene.add(pointLight);

      createCelestialBodies();
      createApolloAsteroidOrbits();
      createGUI();

      window.addEventListener('resize', onWindowResize, false);
    }

    function createCelestialBodies() {
      const sunGeometry = new THREE.SphereGeometry(5, 32, 32);
      const sunMaterial = new THREE.MeshBasicMaterial({ color: 0xffff00 });
      sun = new THREE.Mesh(sunGeometry, sunMaterial);
      scene.add(sun);

      mercury = createPlanet(0.383, planetColors.mercury, 10);
      venus = createPlanet(0.949, planetColors.venus, 15);
      earth = createPlanet(1, planetColors.earth, 20);
      mars = createPlanet(0.532, planetColors.mars, 25);
    }

    function createPlanet(radius, color, orbitRadius) {
      const geometry = new THREE.SphereGeometry(radius, 32, 32);
      const material = new THREE.MeshPhongMaterial({ color: color });
      const planet = new THREE.Mesh(geometry, material);
      planet.position.x = orbitRadius;
      scene.add(planet);

      createOrbitLine(orbitRadius, color);

      return planet;
    }

    function createOrbitLine(radius, color) {
      const curve = new THREE.EllipseCurve(
        0, 0,
        radius, radius,
        0, 2 * Math.PI,
        false,
        0
      );

      const points = curve.getPoints(100);
      const geometry = new THREE.BufferGeometry().setFromPoints(points);
      const material = new THREE.LineBasicMaterial({ color: color });
      const ellipse = new THREE.Line(geometry, material);
      ellipse.rotation.x = Math.PI / 2;
      scene.add(ellipse);
      orbitLines.push(ellipse);
    }

    function createApolloAsteroidOrbits() {
      apolloData.forEach((asteroid) => {
        createAsteroidOrbit(asteroid, 0xffffff);
      });
    }

    function createAsteroidOrbit(asteroid, color) {
      const a = asteroid.a * 20; // Scale up the semi-major axis
      const e = asteroid.e;
      const b = a * Math.sqrt(1 - e * e);

      const curve = new THREE.EllipseCurve(
        -a * e, 0,
        a, b,
        0, 2 * Math.PI,
        false,
        0
      );

      const points = curve.getPoints(200);
      const geometry = new THREE.BufferGeometry().setFromPoints(points);
      const material = new THREE.LineBasicMaterial({ color: color });
      const ellipse = new THREE.Line(geometry, material);

      // Apply inclination and other orbital elements
      ellipse.rotation.x = Math.PI / 2;
      ellipse.rotation.y = asteroid.i * Math.PI / 180;
      ellipse.rotation.z = asteroid.om * Math.PI / 180;

      scene.add(ellipse);
      orbitLines.push(ellipse);
    }

    function createGUI() {
      const gui = new dat.GUI();
      const params = {
        showOrbits: true
      };

      gui.add(params, 'showOrbits').name('Show Orbits').onChange((value) => {
        orbitLines.forEach(orbit => orbit.visible = value);
      });
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
      requestAnimationFrame(animate);

      const time = Date.now() * 0.001;

      mercury.position.x = Math.cos(time * 0.5) * 10;
      mercury.position.z = Math.sin(time * 0.5) * 10;

      venus.position.x = Math.cos(time * 0.3) * 15;
      venus.position.z = Math.sin(time * 0.3) * 15;

      earth.position.x = Math.cos(time * 0.2) * 20;
      earth.position.z = Math.sin(time * 0.2) * 20;

      mars.position.x = Math.cos(time * 0.15) * 25;
      mars.position.z = Math.sin(time * 0.15) * 25;

      controls.update();
      renderer.render(scene, camera);
    }

    init();
    animate();
  </script>
</body>
</html>